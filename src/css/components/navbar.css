/* Mobile (Default) */
.navbar {
  @apply h-(--ifm-navbar-height) px-4 flex items-center bg-surface-1 border-b border-border transition-all shadow-none;
}

.navbar__brand {
  @apply font-bold text-text-primary flex items-center gap-2;
}

.navbar__logo {
  @apply h-7 w-7;
}

/* ======================================
   Desktop Vertical Rail (Citizen Style)
   Enabled at lg breakpoint (approx 997px)
====================================== */
@media (min-width: 997px) {
  /* Main Container: Fixed Left Rail */
  .navbar {
    @apply fixed left-0 top-0 bottom-0 w-16 h-screen flex-col py-4 px-0 border-r border-border border-b-0 bg-surface-0 z-50 items-center overflow-visible transform-none! pointer-events-auto!;
  }

  /* Inner Container: Flex Column */
  .navbar__inner {
    @apply flex flex-col h-full w-full items-center gap-2 p-0;
  }

  /* Flatten structure */
  .navbar__items,
  .navbar__items--right {
    @apply contents;
  }

  /* Common Button Style Utility */
  /* We use a consistent width and aspect-square to ensure perfect squares */
  /* w-10 (40px) is standard touch target size */
  .navbar__brand,
  .navbar__toggle,
  .header-github-link,
  .DocSearch-Button,
  button[class*="DocSearch"],
  div[class*="colorModeToggle"] button {
    @apply w-10! h-10! aspect-square! p-0! flex justify-center items-center rounded-md transition-colors mx-auto bg-transparent border-none shadow-none text-text-secondary hover:bg-surface-2 hover:text-text-primary;
    line-height: 0 !important;
  }

  /* Force Icon Sizes for Consistency */
  .DocSearch-Button svg,
  div[class*="colorModeToggle"] button svg {
    @apply w-6! h-6!;
  }

  /* Fix DocSearch Internal Container Alignment */
  .DocSearch-Button-Container {
    @apply flex! justify-center! items-center! w-full! h-full! m-0! p-0!;
  }

  .DocSearch-Button svg {
    @apply m-0! block!;
  }

  /* 1. Logo Area */
  .navbar__brand {
    @apply -order-1 mb-2 relative gap-0;
    font-size: 0;
  }

  /* Divider below logo */
  .navbar__brand::after {
    @apply content-[''] absolute -bottom-2 left-1/2 -translate-x-1/2 w-6 h-0.5 bg-border rounded-sm;
  }

  .navbar__title {
    @apply hidden;
  }
  
  .navbar__logo {
    @apply w-7 h-7 m-0 object-contain;
  }

  /* 2. Search Button */
  .navbar__items .navbar__search {
    @apply contents;
  }

  .DocSearch-Button,
  button[class*="DocSearch"] {
    @apply relative z-50 visible order-0 m-0!;
  }

  .DocSearch-Button-Placeholder,
  .DocSearch-Button-Keys {
    @apply hidden;
  }

  /* 3. Menu Toggle (Hamburger) */
  .navbar__toggle {
    @apply order-1 z-50 relative cursor-pointer;
    
    /* Middle bar */
    background-image: linear-gradient(currentColor, currentColor);
    background-size: 1.25rem 0.125rem;
    background-position: center;
    background-repeat: no-repeat;
    transition: background-size 0.2s ease-in-out;
  }
  
  /* Hide default SVG */
  .navbar__toggle svg {
    @apply hidden;
  }

  /* Top and Bottom bars */
  .navbar__toggle::before,
  .navbar__toggle::after {
    @apply content-[''] absolute left-1/2 w-5 h-0.5 bg-current -translate-x-1/2 transition-transform origin-center;
  }

  .navbar__toggle::before {
    @apply -translate-y-1.5;
  }

  .navbar__toggle::after {
    @apply translate-y-1.5;
  }

  .navbar__toggle:hover::before {
    @apply -translate-x-1/2;
  }

  /* Active State */
  .navbar-sidebar--show .navbar__toggle,
  html.citizen-menu-open .navbar__toggle {
    background-size: 0 0.125rem;
  }

  .navbar-sidebar--show .navbar__toggle::before,
  html.citizen-menu-open .navbar__toggle::before {
    @apply top-1/2 -translate-y-1/2 rotate-45;
  }

  .navbar-sidebar--show .navbar__toggle::after,
  html.citizen-menu-open .navbar__toggle::after {
    @apply bottom-1/2 translate-y-1/2 -rotate-45;
  }

  /* Hide standard nav links */
  .navbar__items:not(.navbar__items--right) .navbar__item {
    @apply hidden;
  }

  /* 4. Bottom Actions */
  .navbar__item {
    @apply order-10;
  }

  /* GitHub Link */
  .header-github-link {
    @apply order-99 mt-auto mb-0 overflow-hidden;
    font-size: 0;
  }

  /* GitHub Icon Mask */
  .header-github-link::before {
    @apply content-[''] block w-5 h-5 bg-text-secondary transition-colors;
    mask: url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E") no-repeat center;
    mask-size: contain;
    -webkit-mask-size: contain;
  }
  
  .header-github-link:hover::before {
    @apply bg-text-primary;
  }

  /* Color Toggle */
  div[class*="colorModeToggle"] {
    @apply order-100 mt-2 mx-auto w-10 h-10 flex justify-center items-center;
  }

  /* ======================================
     Sidebar Drawer
  ====================================== */
  .navbar-sidebar {
    @apply block left-16! w-80! -translate-x-full bg-surface-0 border-r border-border shadow-none transition-transform z-40 p-0;
  }

  .navbar-sidebar--show .navbar-sidebar {
    @apply translate-x-0;
  }

  .navbar-sidebar__backdrop {
    @apply left-16! z-30 bg-black/40;
  }

  /* Clean up Sidebar Content */
  .navbar-sidebar__brand,
  .navbar-sidebar__close,
  .navbar-sidebar__items .header-github-link,
  .navbar-sidebar__items .navbar__item[href*="github.com"] {
    @apply hidden;
  }

  .navbar-sidebar__items {
    @apply h-full p-0;
  }

  .navbar-sidebar__items > .menu {
    @apply pt-10 px-3 pb-2 bg-transparent w-full box-border;
  }

  .navbar-sidebar__items .menu__link {
    @apply rounded text-text-secondary py-2 px-3 text-sm font-medium leading-tight;
  }

  .navbar-sidebar__items .menu__link:hover {
    @apply bg-surface-2 text-text-primary no-underline;
  }

  .navbar-sidebar__items .menu__link--active {
    @apply bg-surface-3 text-text-primary font-bold;
  }
}

/* Mobile Layout */
@media (max-width: 996px) {
  .navbar__inner {
    @apply flex justify-between;
  }
  .navbar__brand {
    @apply absolute left-1/2 -translate-x-1/2;
  }
  .navbar__items, .navbar__items--right {
    @apply flex;
  }
  .navbar__items--right {
    @apply ml-auto;
  }
}
